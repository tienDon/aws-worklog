<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=https://tiendon.github.io/aws-worklog/images/favicon.png type=image/png><title>Blog 1 :: Báo cáo thực tập</title>
<link href=https://tiendon.github.io/aws-worklog/css/nucleus.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/fontawesome-all.min.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/hybrid.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/featherlight.min.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/perfect-scrollbar.min.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/auto-complete.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/atom-one-dark-reasonable.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/theme.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/hugo-theme.css?1765436012 rel=stylesheet><link href=https://tiendon.github.io/aws-worklog/css/theme-workshop.css?1765436012 rel=stylesheet><script src=https://tiendon.github.io/aws-worklog/js/jquery-3.3.1.min.js?1765436012></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/3.1-blog1/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://tiendon.github.io/aws-worklog/><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://tiendon.github.io/aws-worklog/js/lunr.min.js?1765436012></script><script type=text/javascript src=https://tiendon.github.io/aws-worklog/js/auto-complete.js?1765436012></script><script type=text/javascript>var baseurl="https://tiendon.github.io/aws-worklog//vi"</script><script type=text/javascript src=https://tiendon.github.io/aws-worklog/js/search.js?1765436012></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-worklog/ title="Nhật ký công việc" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/><b>1. </b>Nhật ký công việc
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/1-worklog/1.1-week1/ title="Nhật ký công việc Tuần 1" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.1-week1/><b>1.1. </b>Nhật ký công việc Tuần 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.2-week2/ title="Nhật ký công việc Tuần 2" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.2-week2/><b>1.2. </b>Nhật ký công việc Tuần 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.3-week3/ title="Nhật ký công việc Tuần 3" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.3-week3/><b>1.3. </b>Nhật ký công việc Tuần 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.4-week4/ title="Nhật ký công việc Tuần 4" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.4-week4/><b>1.4. </b>Nhật ký công việc Tuần 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.5-week5/ title="Nhật ký công việc Tuần 5" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.5-week5/><b>1.5. </b>Nhật ký công việc Tuần 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.6-week6/ title="Nhật ký công việc Tuần 6" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.6-week6/><b>1.6. </b>Nhật ký công việc Tuần 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.7-week7/ title="Nhật ký công việc Tuần 7" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.7-week7/><b>1.7. </b>Nhật ký công việc Tuần 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.8-week8/ title="Nhật ký công việc Tuần 8" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.8-week8/><b>1.8. </b>Nhật ký công việc Tuần 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.9-week9/ title="Nhật ký công việc Tuần 9" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.9-week9/><b>1.9. </b>Nhật ký công việc Tuần 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.10-week10/ title="Nhật ký công việc Tuần 10" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.10-week10/><b>1.10. </b>Nhật ký công việc Tuần 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.11-week11/ title="Nhật ký công việc Tuần 11" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.11-week11/><b>1.11. </b>Nhật ký công việc Tuần 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.12-week12/ title="Nhật ký công việc Tuần 12" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/1-worklog/1.12-week12/><b>1.12. </b>Nhật ký công việc Tuần 12
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/2-proposal/ title="Bản đề xuất" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/2-proposal/><b>2. </b>Bản đề xuất
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/ title="Các bài blogs đã dịch" class="dd-item
parent"><a href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/><b>3. </b>Các bài blogs đã dịch
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-blogstranslated/3.1-blog1/ title="Blog 1" class="dd-item
active"><a href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.2-blog2/ title="Blog 2" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.4-blog4/ title="Blog 4" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/3.4-blog4/><b>3.4. </b>Blog 4
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-eventparticipated/ title="Các events đã tham gia" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/4-eventparticipated/><b>4. </b>Các events đã tham gia
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/4-eventparticipated/4.2-event2/><b>4.2. </b>Event 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.3-event3/ title="Event 3" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/4-eventparticipated/4.3-event3/><b>4.3. </b>Event 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.4-event4/ title="Event 4" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/4-eventparticipated/4.4-event4/><b>4.4. </b>Event 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.5-event5/ title="Event 5" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/4-eventparticipated/4.5-event5/><b>4.5. </b>Event 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.6-event6/ title="Event 6" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/4-eventparticipated/4.6-event6/><b>4.6. </b>Event 6
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/ title=Workshop class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/6-self-evaluation/ title="Tự đánh giá" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/6-self-evaluation/><b>6. </b>Tự đánh giá
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-feedback/ title="Chia sẻ, đóng góp ý kiến" class=dd-item><a href=https://tiendon.github.io/aws-worklog/vi/7-feedback/><b>7. </b>Chia sẻ, đóng góp ý kiến
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://tiendon.github.io/aws-worklog/3-blogstranslated/3.1-blog1/>English</option><option id=vi value=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/3.1-blog1/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate="10/12/2025";document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=https://tiendon.github.io/aws-worklog/vi/>Báo cáo thực tập</a> > <a href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/>Các bài blogs đã dịch</a> > Blog 1</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#giới-thiệu>Giới thiệu</a></li><li><a href=#triển-khai-hybrid>Triển khai hybrid</a><ul><li><a href=#kiến-trúc>Kiến trúc</a></li></ul></li><li><a href=#ưu-điểm-khi-sử-dụng-cách-tiếp-cận-triển-khai-hybrid--stylefont-size-18px>Ưu điểm khi sử dụng cách tiếp cận triển khai hybrid {: style=&ldquo;font-size: 18px;&rdquo;}</a></li><li><a href=#điều-kiện-tiên-quyết-cho-việc-di-chuyển>Điều kiện tiên quyết cho việc di chuyển</a></li><li><a href=#di-chuyển-ứng-dụng-của-bạn-sử-dụng-triển-khai-hybrid-với-nlb--stylefont-size-18px>Di chuyển ứng dụng của bạn sử dụng triển khai hybrid với NLB {: style=&ldquo;font-size: 18px;&rdquo;}</a><ul><li><a href=#các-bước-di-chuyển-chi-tiết--stylefont-size-16px>Các bước di chuyển chi tiết {: style=&ldquo;font-size: 16px;&rdquo;}</a></li><li><a href=#di-chuyển-lưu-lượng-từ-amazon-ec2-sang-target-group-amazon-eks--stylefont-size-16px>Di chuyển lưu lượng từ Amazon EC2 sang target group Amazon EKS {: style=&ldquo;font-size: 16px;&rdquo;}</a></li><li><a href=#quy-trình-rollback-về-target-group-ban-đầu-nếu-cần--stylefont-size-16px>Quy trình rollback về target group ban đầu (Nếu cần) {: style=&ldquo;font-size: 16px;&rdquo;}</a></li><li><a href=#dọn-dẹp-sau-di-chuyển--stylefont-size-16px>Dọn dẹp sau di chuyển {: style=&ldquo;font-size: 16px;&rdquo;}</a></li></ul></li><li><a href=#kết-luận>Kết luận</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 1</h1><h1 id=hiện-đại-hóa-ứng-dụng-không-khó-khăn-di-chuyển-sang-amazon-eks-với-cấu-hình-nlb-hiện-có>Hiện đại hóa ứng dụng không khó khăn: di chuyển sang Amazon EKS với cấu hình NLB hiện có</h1><p><strong>Tác giả:</strong></p><ul><li>Henrique Santana, Chuyên gia Container, AWS</li><li>Luis Felipe, Kiến trúc sư Giải pháp Chính, AWS</li></ul><p><em>Ngày: 25 tháng 3, 2025</em></p><style>body{font-family:times new roman,Times,serif;font-size:13px}h1{font-size:24px}h2{font-size:18px}h3{font-size:16px}</style><h2 id=giới-thiệu>Giới thiệu</h2><p>Nhiều tổ chức đã xây dựng cơ sở hạ tầng của họ sử dụng <a href=https://aws.amazon.com/ec2/>Amazon Elastic Compute Cloud (Amazon EC2)</a> và <a href=https://aws.amazon.com/elasticloadbalancing/network-load-balancer/>Network Load Balancer (NLB)</a>, thường với các chính sách bảo mật được xây dựng xung quanh địa chỉ IP tĩnh của NLB. Khi các tổ chức này áp dụng container hóa và chuyển sang <a href=https://aws.amazon.com/eks/>Amazon Elastic Kubernetes Service (Amazon EKS)</a> cho các ứng dụng hiện đại của họ, họ phải đối mặt với thách thức đáng kể trong việc duy trì cấu hình endpoint hiện có của họ. Điều này có thể làm cho việc hiện đại hóa trở nên phức tạp và rủi ro, vì việc thay đổi cấu hình cân bằng tải có thể làm gián đoạn kết nối của khách hàng hoặc đòi hỏi những thay đổi DNS lớn.</p><p>Tin tốt là quá trình chuyển đổi này không nhất thiết phải là một nỗ lực tất cả hoặc không có gì. Trong bài đăng này, chúng tôi khám phá một <a href=https://aws.amazon.com/blogs/containers/patterns-for-targetgroupbinding-with-aws-load-balancer-controller/>mẫu triển khai hybrid</a> cung cấp một con đường di chuyển mượt mà, ít rủi ro từ Amazon EC2 sang Amazon EKS.</p><h2 id=triển-khai-hybrid>Triển khai hybrid</h2><p>Tương tự như mẫu <a href=https://docs.aws.amazon.com/whitepapers/latest/overview-deployment-options/bluegreen-deployments.html>triển khai blue/green</a>, cách tiếp cận triển khai hybrid của chúng tôi hỗ trợ chạy ứng dụng đồng thời trên Amazon EKS và Amazon EC2 trong quá trình di chuyển. Chìa khóa cho chiến lược này là khả năng định tuyến lưu lượng thông qua bộ cân bằng tải hiện có của bạn đến cả hai triển khai bằng cách sử dụng TargetGroupBinding, dẫn đến một quá trình di chuyển có kiểm soát.</p><h3 id=kiến-trúc>Kiến trúc</h3><p><img alt="Hình 1: Sơ đồ luồng lưu lượng thể hiện việc di chuyển từ Amazon EC2 (màu xanh lá cây) sang Amazon EKS (màu xanh dương)" src=https://d2908q01vomqb2.cloudfront.net/fe2ef495a1152561572949784c16bf23abb28057/2025/03/18/Picture1-8.png></p><p><em>Hình 1: Sơ đồ luồng lưu lượng thể hiện việc di chuyển từ Amazon EC2 (màu xanh lá cây) sang Amazon EKS (màu xanh dương)</em></p><h2 id=ưu-điểm-khi-sử-dụng-cách-tiếp-cận-triển-khai-hybrid--stylefont-size-18px>Ưu điểm khi sử dụng cách tiếp cận triển khai hybrid {: style=&ldquo;font-size: 18px;&rdquo;}</h2><p>Cách tiếp cận triển khai hybrid mang lại những ưu điểm sau:</p><p>• <strong>Di chuyển có kiểm soát:</strong> Định tuyến lưu lượng dần dần đến workload EKS trong khi vẫn duy trì dịch vụ thông qua cơ sở hạ tầng EC2 hiện có của bạn, giảm đáng kể rủi ro di chuyển.</p><p>• <strong>Rollback đơn giản:</strong> Nhanh chóng chuyển hướng lưu lượng trở lại các instance EC2 nếu phát sinh vấn đề, cung cấp khả năng rollback đáng tin cậy trong quá trình di chuyển.</p><p>• <strong>A/B testing:</strong> So sánh hiệu suất giữa triển khai EC2 và EKS trong điều kiện thực tế, cung cấp quyết định dựa trên dữ liệu về cấu hình và phân bổ tài nguyên hiệu quả nhất.</p><p>• <strong>Tính linh hoạt:</strong> Sử dụng điểm mạnh của cả hai môi trường triển khai trong quá trình chuyển đổi, giúp tối ưu hóa việc đặt workload dựa trên yêu cầu cụ thể.</p><p>• <strong>Giảm thiểu gián đoạn dịch vụ:</strong> Giảm rủi ro downtime bằng cách vận hành đồng thời cả hai môi trường trong quá trình di chuyển.</p><p>• <strong>Giảm thiểu rủi ro:</strong> Xác thực triển khai container hóa với lưu lượng thực trong khi duy trì tùy chọn fallback, cung cấp tính liên tục kinh doanh.</p><h2 id=điều-kiện-tiên-quyết-cho-việc-di-chuyển>Điều kiện tiên quyết cho việc di chuyển</h2><p>Bài đăng này được viết với giả định rằng bạn có hiểu biết cơ bản về container hóa Docker và các khái niệm Kubernetes (pods, events, namespaces, và deployments, v.v.).</p><p>Trước khi bắt đầu quá trình di chuyển, hãy đảm bảo bạn có sẵn các thành phần sau:</p><p>• <strong>Cơ sở hạ tầng hiện có:</strong> Trong ví dụ của chúng tôi, một <a href=https://github.com/aws-containers/retail-store-sample-app>ứng dụng mẫu Retail Store</a> đang chạy trên Amazon EC2.</p><p>• <strong>Yêu cầu về container:</strong> Một ứng dụng đã được kiểm thử và container hóa, với container image được đẩy lên registry container, như <a href=https://aws.amazon.com/ecr/>Amazon Elastic Container Registry (Amazon ECR)</a>.</p><p>• <strong>Môi trường Amazon EKS:</strong> <a href=https://docs.aws.amazon.com/eks/latest/userguide/kubernetes-versions.html#available-versions>Cluster EKS với phiên bản Kubernetes được hỗ trợ</a> trên nhiều <a href=https://aws.amazon.com/about-aws/global-infrastructure/regions_az/>Availability Zones (AZs)</a>.</p><p>• <strong>Công cụ:</strong>
◦ <a href=https://docs.aws.amazon.com/eks/latest/userguide/install-kubectl.html>kubectl</a> đã được cài đặt và cấu hình để tương tác với cluster Amazon EKS.
◦ <a href=https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html>AWS Command Line Interface (AWS CLI)</a> đã được cài đặt và cấu hình với <a href=https://aws.amazon.com/iam/>AWS Identity and Access Management (IAM)</a> phù hợp.
◦ <a href=https://docs.aws.amazon.com/eks/latest/userguide/lbc-helm.html>AWS Load Balancer Controller</a> đã được cài đặt trên cluster Amazon EKS.</p><h2 id=di-chuyển-ứng-dụng-của-bạn-sử-dụng-triển-khai-hybrid-với-nlb--stylefont-size-18px>Di chuyển ứng dụng của bạn sử dụng triển khai hybrid với NLB {: style=&ldquo;font-size: 18px;&rdquo;}</h2><h3 id=các-bước-di-chuyển-chi-tiết--stylefont-size-16px>Các bước di chuyển chi tiết {: style=&ldquo;font-size: 16px;&rdquo;}</h3><p>Bước đầu tiên là tạo một target group mới:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TARGET_GROUP_ARN<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>aws elbv2 create-target-group <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --name eks-green <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --protocol TCP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --port <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-type ip <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --vpc-id &lt;VPCID&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --query <span style=color:#e6db74>&#39;TargetGroups[0].TargetGroupArn&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --output text<span style=color:#66d9ef>)</span>
</span></span></code></pre></div><p>ARN (Amazon Resource Name) của target group được lưu vào biến TARGET_GROUP_ARN. Sau đó, xác minh rằng cả hai target group (Amazon EC2 và Amazon EKS) được cấu hình với <code>Terminate connections on deregistration</code> là true.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 describe-target-group-attributes <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn $TARGET_GROUP_ARN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --query <span style=color:#e6db74>&#39;Attributes[*]&#39;</span> --output text | <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    grep deregistration_delay.connection_termination.enabled
</span></span></code></pre></div><p>Quan sát output sau:</p><p><code>deregistration_delay.connection_termination.enabled true</code></p><p>Nếu output của lệnh trả về thuộc tính <code>false</code>, điều đó có nghĩa là tính năng này chưa được kích hoạt. Để kích hoạt, sử dụng lệnh sau:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 modify-target-group-attributes <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn $TARGET_GROUP_ARN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --attributes <span style=color:#e6db74>&#39;Key=deregistration_delay.connection_termination.enabled,Value=true&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --query <span style=color:#e6db74>&#39;Attributes[*]&#39;</span> --output text | <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    grep deregistration_delay.connection_termination.enabled
</span></span></code></pre></div><p>Ở giai đoạn này, lưu lượng vẫn được hướng đến ứng dụng đang chạy trên Amazon EC2. Bây giờ bạn có thể triển khai ứng dụng đã container hóa trên cluster Amazon EKS:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create deployment myapp <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --image public.ecr.aws/aws-containers/retail-store-sample-ui:0.8.1 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --replicas <span style=color:#ae81ff>2</span> --port<span style=color:#f92672>=</span><span style=color:#ae81ff>8080</span>
</span></span></code></pre></div><p>Chúng ta có thể expose ứng dụng bằng cách tạo một service. Đây là file YAML cho service:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt; EOF &gt; service.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>myapp</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ui-service</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>myapp</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>ClusterIP</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><p>Chúng ta có thể apply nó:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f service.yaml
</span></span></code></pre></div><p>Với ứng dụng đang chạy và được expose như một Kubernetes service, tạo một listener mới cho NLB hiện có:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 create-listener <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --load-balancer-arn &lt;NLB-ARN&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --protocol TCP --port <span style=color:#ae81ff>81</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --default-actions Type<span style=color:#f92672>=</span>forward,TargetGroupArn<span style=color:#f92672>=</span>$TARGET_GROUP_ARN
</span></span></code></pre></div><p>Hiện tại bạn có một listener trên cổng 80. Listener này tiếp tục chuyển tiếp lưu lượng đến target group được liên kết với các instance EC2. Listener mới được tạo chuyển tiếp lưu lượng đến target group được liên kết với Amazon EKS. Nó không có bất kỳ target nào cho đến khi bạn sử dụng TargetGroupBinding để liên kết service với target group mới. Chúng ta có thể tạo nó:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt; EOF &gt; tg-binding.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>elbv2.k8s.aws/v1beta1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>TargetGroupBinding</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ui-tgbinding</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>serviceRef</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ui-service</span> <span style=color:#75715e># Tên service</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span> <span style=color:#75715e># Cổng service</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>targetGroupARN</span>: <span style=color:#ae81ff>$TARGET_GROUP_ARN</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><p>Apply manifest:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f tg-binding.yaml
</span></span></code></pre></div><p>Bạn có thể xác minh rằng các target được đăng ký đúng cách vào target group Amazon EKS. Cho các target đủ thời gian để vượt qua kiểm tra sức khỏe, sau đó xác minh rằng các target mới có thể phục vụ lưu lượng thành công. Nếu kiểm tra sức khỏe thất bại, hãy xác minh rằng Security Group của node Amazon EKS cho phép lưu lượng cần thiết. Để xác nhận chức năng phù hợp, hãy thử truy cập ứng dụng thông qua listener mới để đảm bảo nó đang được phục vụ như dự định trước khi tiến hành thêm.</p><p>Trước khi bắt đầu di chuyển, bạn cần tạo một listener khác trỏ đến target group EC2 hiện có:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 create-listener <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --load-balancer-arn &lt;NLB-ARN&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --protocol TCP --port <span style=color:#ae81ff>82</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --default-actions Type<span style=color:#f92672>=</span>forward,TargetGroupArn<span style=color:#f92672>=</span>&lt;EC2-TARGET-GROUP-ARN&gt;
</span></span></code></pre></div><p>Sau bước này, NLB có ba listener (cổng 80, 81 và 82), nơi bạn đã tạo thêm hai listener để thực hiện hoạt động di chuyển lưu lượng mượt mà. Số cổng được sử dụng trong bài đăng này là ví dụ, và bạn có thể chọn số cổng để phản ánh nhu cầu ứng dụng của bạn. Chúng tôi khuyên bạn nên kiểm tra xem lưu lượng đến các target group hiện có có được phục vụ trên listener mới hay không. Điều này đảm bảo rằng cấu hình NLB đã sẵn sàng để tiến hành các bước tiếp theo.</p><h3 id=di-chuyển-lưu-lượng-từ-amazon-ec2-sang-target-group-amazon-eks--stylefont-size-16px>Di chuyển lưu lượng từ Amazon EC2 sang target group Amazon EKS {: style=&ldquo;font-size: 16px;&rdquo;}</h3><p>Cả hai target group đều khỏe mạnh, và tất cả các listener đều sẵn sàng xử lý lưu lượng, vì vậy đã đến lúc di chuyển lưu lượng. Đầu tiên, cấu hình listener hiện có trên cổng 80 để gửi lưu lượng đến target group <code>eks-green</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 modify-listener <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --listener-arn &lt;NLB-Listen-80&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --default-actions Type<span style=color:#f92672>=</span>forward,TargetGroupArn<span style=color:#f92672>=</span>$TARGET_GROUP_ARN
</span></span></code></pre></div><p>Thay đổi cấu hình này đảm bảo rằng tất cả các luồng mới được chuyển hướng đến target group mới. Vì các target đã vượt qua kiểm tra sức khỏe của họ khi được liên kết với listener trên cổng 81, điều này giúp tăng tốc quá trình này.</p><p>Thay đổi listener này có thể mất vài phút để lan truyền. Do đó, chúng tôi đề xuất bạn theo dõi lưu lượng đi đến các target trong target group mới trước khi tiến hành các bước tiếp theo. Trong thời gian này, điều quan trọng là phải theo dõi hành vi và số liệu hiệu suất của ứng dụng của bạn. Bạn có thể theo dõi trạng thái sức khỏe của target bằng cách sử dụng:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 describe-target-health <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn $TARGET_GROUP_ARN
</span></span></code></pre></div><p>Mặc dù các kết nối hiện có sẽ không bị ảnh hưởng, các kết nối mới sẽ ngừng định tuyến đến target group cũ sau khi hoàn thành di chuyển lưu lượng. Sau khi xác nhận rằng các target mới đang xử lý lưu lượng thành công và các target tồn tại trước đó không còn phục vụ lưu lượng nữa, lấy danh sách các target từ target group EC2 tồn tại trước đó để chuẩn bị hủy đăng ký:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 describe-target-health <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn &lt;EC2-TARGET-GROUP-ARN&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --query <span style=color:#e6db74>&#39;TargetHealthDescriptions[*].Target.Id&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --output text
</span></span></code></pre></div><p>Lệnh này xuất ra danh sách các ID instance. Đối với mỗi ID instance, chạy lệnh <code>deregister-targets</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 deregister-targets <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn &lt;EC2-TARGET-GROUP-ARN&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --targets Id<span style=color:#f92672>=</span>&lt;InstanceID&gt;
</span></span></code></pre></div><p>Bước hủy đăng ký rất quan trọng vì target group EC2 vẫn được liên kết với NLB thông qua listener cổng 82. Khi được thực hiện, lệnh gọi deregister-targets thực thi <code>Connection termination on deregistration</code>, điều này kết thúc các kết nối hiện có đến các target cũ. Khi khách hàng kết nối lại, họ được định tuyến đến các target của target group Amazon EKS mới.</p><h3 id=quy-trình-rollback-về-target-group-ban-đầu-nếu-cần--stylefont-size-16px>Quy trình rollback về target group ban đầu (Nếu cần) {: style=&ldquo;font-size: 16px;&rdquo;}</h3><p>Nếu bạn cần rollback về target group EC2 ban đầu, hãy làm theo các bước sau:</p><ol><li>Đăng ký lại tất cả các target ban đầu vào target group EC2:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 register-targets <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn &lt;EC2-TARGET-GROUP-ARN&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --targets Id<span style=color:#f92672>=</span>&lt;InstanceID1&gt; Id<span style=color:#f92672>=</span>&lt;InstanceID2&gt;
</span></span></code></pre></div><ol start=2><li>Đợi các target vượt qua kiểm tra sức khỏe. Theo dõi trạng thái sức khỏe của họ:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 describe-target-health <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn &lt;EC2-TARGET-GROUP-ARN&gt;
</span></span></code></pre></div><ol start=3><li>Cấu hình lại listener trên cổng 80 trên NLB để gửi lưu lượng đến target group EC2:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 modify-listener <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --listener-arn &lt;NLB-Listen-80&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --default-actions Type<span style=color:#f92672>=</span>forward,TargetGroupArn<span style=color:#f92672>=</span>&lt;EC2-TARGET-GROUP-ARN&gt;
</span></span></code></pre></div><h3 id=dọn-dẹp-sau-di-chuyển--stylefont-size-16px>Dọn dẹp sau di chuyển {: style=&ldquo;font-size: 16px;&rdquo;}</h3><p>Nếu việc di chuyển đã thành công (không cần rollback), thì bạn có thể tiến hành các hoạt động dọn dẹp. Điều này bao gồm việc xóa hai listener bổ sung mà bạn đã tạo trên cổng 81 và 82, vì chúng chỉ cần thiết cho quá trình di chuyển. Cuối cùng, bạn có thể xóa an toàn target group EC2, vì nó không còn nhận bất kỳ lưu lượng nào nữa.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws elbv2 delete-listener <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     --listener-arn &lt;Listen-Port81-ARN&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aws elbv2 delete-listener <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     --listener-arn &lt;Listen-Port82-ARN&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aws elbv2 delete-target-group <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --target-group-arn &lt;EC2-TG-ARN&gt;
</span></span></code></pre></div><h2 id=kết-luận>Kết luận</h2><p>Mẫu triển khai hybrid sử dụng NLB và TargetGroupBinding cung cấp một cách tiếp cận thực tế, ít rủi ro để di chuyển ứng dụng sang Amazon EKS từ nhiều nguồn khác nhau, bao gồm Amazon EC2, cơ sở hạ tầng on-premises, hoặc các giải pháp điều phối container khác. Duy trì cấu hình NLB hiện có, trong khi dần dần chuyển lưu lượng sang workload được container hóa, cho phép phương pháp này hỗ trợ chuyển đổi mượt mà và cung cấp khả năng rollback tích hợp. Mặc dù chúng tôi đã tập trung vào việc di chuyển từ Amazon EC2 sang Amazon EKS, tính linh hoạt của mẫu này mở rộng cho nhiều kịch bản khác nhau, bao gồm chuyển đổi từ cơ sở hạ tầng on-premises hoặc các giải pháp điều phối container khác.</p><p>Những cải tiến gần đây cho AWS Load Balancer Controller, đặc biệt là việc giới thiệu <a href=https://kubernetes-sigs.github.io/aws-load-balancer-controller/latest/guide/use_cases/multi_cluster/>target group MultiCluster</a>, mở rộng thêm các khả năng này. Các tổ chức giờ đây có thể quản lý workload trên nhiều cluster Kubernetes và tích hợp với các tài nguyên không thuộc cluster, tạo điều kiện cho các chiến lược di chuyển phức tạp hơn và kiến trúc ứng dụng phân tán. Cách tiếp cận hybrid này đóng vai trò như một bản thiết kế đáng tin cậy cho việc hiện đại hóa, cung cấp các công cụ cần thiết để duy trì tính liên tục kinh doanh và giảm thiểu rủi ro đồng thời cung cấp tính linh hoạt để thích ứng với các yêu cầu cơ sở hạ tầng đang phát triển.</p><p>Để tiếp tục hành trình di chuyển của bạn, chúng tôi khuyên bạn nên đọc bài đăng đồng hành của chúng tôi: <a href=https://aws.amazon.com/blogs/containers/migrating-from-self-managed-kubernetes-to-amazon-eks-here-are-some-key-considerations/>Di chuyển từ Kubernetes tự quản lý sang Amazon EKS: Đây là một số cân nhắc chính</a>. Bài đăng này cung cấp thêm những hiểu biết sâu sắc và thực hành tốt nhất bổ sung cho chiến lược triển khai hybrid được thảo luận ở đây, đặc biệt nếu bạn đang di chuyển từ môi trường Kubernetes tự quản lý sang Amazon EKS.</p><p><strong>TAGS:</strong> <a href=https://aws.amazon.com/blogs/containers/tag/eks/>EKS</a>, <a href=https://aws.amazon.com/blogs/containers/tag/elb/>elb</a>, <a href=https://aws.amazon.com/blogs/containers/tag/nlb/>nlb</a></p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/ title="Các bài blogs đã dịch"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=https://tiendon.github.io/aws-worklog/vi/3-blogstranslated/3.2-blog2/ title="Blog 2" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://tiendon.github.io/aws-worklog/js/clipboard.min.js?1765436012></script><script src=https://tiendon.github.io/aws-worklog/js/perfect-scrollbar.min.js?1765436012></script><script src=https://tiendon.github.io/aws-worklog/js/perfect-scrollbar.jquery.min.js?1765436012></script><script src=https://tiendon.github.io/aws-worklog/js/jquery.sticky.js?1765436012></script><script src=https://tiendon.github.io/aws-worklog/js/featherlight.min.js?1765436012></script><script src=https://tiendon.github.io/aws-worklog/js/highlight.pack.js?1765436012></script><script>hljs.initHighlightingOnLoad()</script><script src=https://tiendon.github.io/aws-worklog/js/modernizr.custom-3.6.0.js?1765436012></script><script src=https://tiendon.github.io/aws-worklog/js/learn.js?1765436012></script><script src=https://tiendon.github.io/aws-worklog/js/hugo-learn.js?1765436012></script><link href=https://tiendon.github.io/aws-worklog/mermaid/mermaid.css?1765436012 rel=stylesheet><script src=https://tiendon.github.io/aws-worklog/mermaid/mermaid.js?1765436012></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>